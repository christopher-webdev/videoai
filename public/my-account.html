<!DOCTYPE html>
<html lang="en">
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="theme-style-mode" content="1" />
        <!-- 0 == light, 1 == dark -->

        <title>My Account</title>
        <!-- Favicon -->
        <link
            rel="shortcut icon"
            type="image/x-icon"
            href="assets/images/logo/favicon.png"
        />
        <!-- CSS ============================================ -->
        <link rel="stylesheet" href="assets/css/vendor/bootstrap.min.css" />
        <link
            rel="stylesheet"
            href="assets/css/plugins/fontawesome-all.min.css"
        />
        <link rel="stylesheet" href="assets/css/plugins/feature.css" />
        <link rel="stylesheet" href="assets/css/plugins/animation.css" />
        <link rel="stylesheet" href="assets/css/plugins/slick.css" />
        <link rel="stylesheet" href="assets/css/plugins/slick-theme.css" />
        <link
            rel="stylesheet"
            href="assets/css/plugins/bootstrap-select.min.css"
        />
        <link rel="stylesheet" href="assets/css/plugins/prism.css" />
        <link rel="stylesheet" href="assets/css/style.css" />
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>
    <!-- Start of LiveChat (www.livechat.com) code -->
    <script>
        window.__lc = window.__lc || {};
        window.__lc.license = 18422055;
        window.__lc.integration_name = 'manual_channels';
        window.__lc.product_name = 'livechat';
        (function (n, t, c) {
            function i(n) {
                return e._h ? e._h.apply(null, n) : e._q.push(n);
            }
            var e = {
                _q: [],
                _h: null,
                _v: '2.0',
                on: function () {
                    i(['on', c.call(arguments)]);
                },
                once: function () {
                    i(['once', c.call(arguments)]);
                },
                off: function () {
                    i(['off', c.call(arguments)]);
                },
                get: function () {
                    if (!e._h)
                        throw new Error(
                            "[LiveChatWidget] You can't use getters before load."
                        );
                    return i(['get', c.call(arguments)]);
                },
                call: function () {
                    i(['call', c.call(arguments)]);
                },
                init: function () {
                    var n = t.createElement('script');
                    (n.async = !0),
                        (n.type = 'text/javascript'),
                        (n.src = 'https://cdn.livechatinc.com/tracking.js'),
                        t.head.appendChild(n);
                },
            };
            !n.__lc.asyncInit && e.init(),
                (n.LiveChatWidget = n.LiveChatWidget || e);
        })(window, document, [].slice);
    </script>
    <noscript
        ><a href="https://www.livechat.com/chat-with/18422055/" rel="nofollow"
            >Chat with us</a
        >, powered by
        <a
            href="https://www.livechat.com/?welcome"
            rel="noopener nofollow"
            target="_blank"
            >LiveChat</a
        ></noscript
    >
    <!-- End of LiveChat code -->

    <body>
        <main class="page-wrapper rbt-dashboard-page">
            <div class="rbt-panel-wrapper">
                <header
                    class="rbt-dashboard-header rainbow-header header-default header-left-align rbt-fluid-header"
                >
                    <div class="container-fluid position-relative">
                        <div
                            class="row align-items-center justify-content-between"
                        >
                            <div class="col-lg-2 col-md-6 col-6">
                                <div class="header-left d-flex">
                                    <div class="expand-btn-grp">
                                        <button
                                            class="bg-solid-primary popup-dashboardleft-btn"
                                        >
                                            <i
                                                class="fa-sharp fa-regular fa-sidebar"
                                            ></i>
                                        </button>
                                    </div>
                                    <div class="logo">
                                        <a href="index.html">
                                            <img
                                                class="logo-light"
                                                src="assets/images/logo/logo.png"
                                                alt="ChatBot Logo"
                                            />
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 d-none d-lg-block text-center">
                                <nav
                                    class="mainmenu-nav d-none d-lg-inline-block text-center"
                                >
                                    <ul class="mainmenu">
                                        <li><a href="index.html">Home</a></li>
                                        <li>
                                            <a href="pricing.html">Pricing</a>
                                        </li>

                                        <li>
                                            <a href="utilize.html"
                                                >How to use</a
                                            >
                                        </li>
                                        <li>
                                            <a href="affiliate-program.html"
                                                >Affiliate</a
                                            >
                                        </li>
                                        <li>
                                            <a href="login.html">Sign out</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                            <div class="col-lg-3 col-md-6 col-6">
                                <div class="header-right">
                                    <!-- Start Mobile-Menu-Bar -->
                                    <div
                                        class="mobile-menu-bar ml--10 d-block d-lg-none"
                                    >
                                        <div class="hamberger">
                                            <button class="hamberger-button">
                                                <i
                                                    class="fa-sharp fa-regular fa-bars"
                                                ></i>
                                            </button>
                                        </div>
                                    </div>
                                    <!-- Start Mobile-Menu-Bar -->
                                    <div
                                        class="rbt-admin-panel account-access rbt-user-wrapper right-align-dropdown"
                                    >
                                        <div class="rbt-admin-card grid-style">
                                            <a
                                                class="d-flex align-items-center"
                                                href="#"
                                            >
                                                <div
                                                    class="inner d-flex align-items-center"
                                                >
                                                    <div class="img-box">
                                                        <img
                                                            id="profile-picture"
                                                            src="assets/images/team/team-01sm.jpg"
                                                            alt="Admin"
                                                            width="100%"
                                                        />
                                                    </div>
                                                    <div class="content">
                                                        <span
                                                            class="title hh-fullname"
                                                            >Adam Milner</span
                                                        >
                                                        <p class="hh-username">
                                                            adam@gmail.com
                                                        </p>
                                                    </div>
                                                </div>
                                                <div class="icon">
                                                    <i
                                                        class="fa-sharp fa-solid fa-chevron-down"
                                                    ></i>
                                                </div>
                                            </a>
                                        </div>
                                        <div class="rbt-user-menu-list-wrapper">
                                            <div class="inner">
                                                <ul
                                                    class="user-list-wrapper user-nav"
                                                >
                                                    <li>
                                                        <a
                                                            href="my-account.html"
                                                            ><i
                                                                class="fa-sharp fa-regular fa-user"
                                                            ></i>
                                                            <span
                                                                >Profile
                                                                Details</span
                                                            ></a
                                                        >
                                                    </li>
                                                    <li>
                                                        <a
                                                            href="/plans-billing.html"
                                                            ><i
                                                                class="fa-sharp fa-regular fa-briefcase"
                                                            ></i>
                                                            <span
                                                                >Plans and
                                                                Billing</span
                                                            ></a
                                                        >
                                                    </li>
                                                </ul>
                                                <hr class="mt--10 mb--10" />
                                                <ul class="user-list-wrapper">
                                                    <li>
                                                        <div class="mt-3 px-4">
                                                            <button
                                                                id="logout-button"
                                                                class="btn h-9 w-full space-x-2 bg-primary text-white hover:bg-primary-focus focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                                                            >
                                                                <!-- Logout icon SVG -->
                                                                <span
                                                                    >Logout</span
                                                                >
                                                            </button>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="expand-btn-grp d-none">
                                        <button
                                            class="bg-solid-primary popup-dashboardright-btn"
                                        >
                                            <i
                                                class="fa-sharp fa-regular fa-sidebar-flip"
                                            ></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>
                <div class="popup-mobile-menu">
                    <div class="inner-popup">
                        <div class="header-top">
                            <div class="logo">
                                <a href="index.html">
                                    <img
                                        class="logo-light"
                                        src="assets/images/logo/logo.png"
                                        alt="ChatBot Logo"
                                    />
                                </a>
                            </div>
                            <div class="close-menu">
                                <button class="close-button">
                                    <i class="fa-sharp fa-regular fa-x"></i>
                                </button>
                            </div>
                        </div>
                        <div class="content">
                            <ul class="mainmenu">
                                <li><a href="index.html">Home</a></li>
                                <li><a href="pricing.html">Pricing</a></li>

                                <li><a href="utilize.html">How to use</a></li>
                                <li>
                                    <a href="affiliate-program.html"
                                        >Affiliate</a
                                    >
                                </li>
                                <li><a href="contact.html">Contact us</a></li>
                                <li><a href="login.html">Sign in</a></li>
                            </ul>
                            <div class="rbt-sm-separator"></div>
                            <div class="rbt-default-sidebar-wrapper"></div>
                        </div>
                        <!-- End Header Btn  -->
                    </div>
                </div>

                <!--  Preloader -->
                <div class="preloader">
                    <div class="loader">
                        <div class="circle"></div>
                        <div class="circle"></div>
                        <div class="circle"></div>
                        <div class="circle"></div>
                        <div class="circle"></div>
                    </div>
                </div>

                <!-- Start Left panel -->
                <div class="rbt-left-panel popup-dashboardleft-section">
                    <div class="rbt-default-sidebar">
                        <div class="inner">
                            <div class="content-item-content">
                                <div class="rbt-default-sidebar-wrapper">
                                    <nav class="mainmenu-nav">
                                        <ul
                                            class="dashboard-mainmenu rbt-default-sidebar-list"
                                        >
                                            <li>
                                                <a href="my-account.html">
                                                    <i
                                                        class="fa-sharp fa-regular fa-user"
                                                    ></i>
                                                    <span>Profile Details</span>
                                                </a>
                                            </li>
                                            <div class="rbt-sm-separator"></div>
                                            <li>
                                                <a href="/plans-billing.html">
                                                    <i
                                                        class="fa-sharp fa-regular fa-briefcase"
                                                    ></i>
                                                    <span
                                                        >Plans and Billing</span
                                                    >
                                                </a>
                                            </li>
                                            <div class="rbt-sm-separator"></div>
                                            <!-- <li>
                                                <a href="/payment-methods.html">
                                                    <i
                                                        class="fa-sharp fa-regular fa-briefcase"
                                                    ></i>
                                                    <span>Payment method</span>
                                                </a>
                                            </li> -->
                                        </ul>
                                    </nav>
                                    <div class="rbt-sm-separator"></div>
                                </div>
                            </div>
                        </div>
                        <div class="subscription-box">
                            <div class="inner">
                                <a class="autor-info" href="my-account.html">
                                    <div class="author-img active">
                                        <img
                                            class="w-100"
                                            src="assets/images/team/team-01sm.jpg"
                                            alt="Author"
                                        />
                                    </div>
                                    <div class="author-desc">
                                        <h6 class="hh-fullname">Adam Milner</h6>
                                        <p class="hh-username">trentadam@net</p>
                                    </div>
                                    <div class="author-badge">Free</div>
                                </a>
                                <div class="btn-part">
                                    <a
                                        class="btn-default btn-border"
                                        href="pricing.html"
                                        >Upgrade To Pro</a
                                    >
                                </div>
                            </div>
                        </div>
                        <p
                            class="subscription-copyright copyright-text text-center b3 small-text"
                        >
                            Â© 2024 <a href="">Cashvipe</a>.
                        </p>
                    </div>
                </div>
                <!-- End Left panel -->

                <!-- Main content -->
                <div class="rbt-main-content mb--0">
                    <div class="rbt-daynamic-page-content center-width">
                        <!-- Dashboard Center Content -->
                        <div class="rbt-dashboard-content">
                            <div class="banner-area">
                                <!-- cashvipesmall Slider -->
                                <div class="settings-area">
                                    <h3 class="title">Profile Details</h3>
                                    <ul class="user-nav">
                                        <li>
                                            <a href="#">
                                                <span>Profile Details</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="content pb--100">
                                <div class="chat-box-list">
                                    <!--Settings Settings -->
                                    <div
                                        class="single-settings-box profile-details-box overflow-hidden"
                                    >
                                        <div class="profile-details-tab">
                                            <div
                                                class="advance-tab-button mb--30"
                                            >
                                                <ul
                                                    class="nav nav-tabs tab-button-style-2 justify-content-start"
                                                    id="settinsTab-4"
                                                    role="tablist"
                                                >
                                                    <li role="presentation">
                                                        <a
                                                            href="#"
                                                            class="tab-button active"
                                                            id="profile-tab"
                                                            data-bs-toggle="tab"
                                                            data-bs-target="#profile"
                                                            role="tab"
                                                            aria-controls="profile"
                                                            aria-selected="true"
                                                        >
                                                            <span class="title"
                                                                >Profile</span
                                                            >
                                                        </a>
                                                    </li>
                                                    <li role="presentation">
                                                        <a
                                                            href="#"
                                                            class="tab-button"
                                                            id="password-tab"
                                                            data-bs-toggle="tab"
                                                            data-bs-target="#password"
                                                            role="tab"
                                                            aria-controls="password"
                                                            aria-selected="false"
                                                        >
                                                            <span class="title"
                                                                >Password</span
                                                            >
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="tab-content">
                                                <div
                                                    class="tab-pane fade active show"
                                                    id="profile"
                                                    role="tabpanel"
                                                    aria-labelledby="profile-tab"
                                                >
                                                    <!-- Start Profile Row  -->
                                                    <form
                                                        id="profile-form"
                                                        action="#"
                                                        class="rbt-profile-row rbt-default-form row row--15"
                                                    >
                                                        <div
                                                            class="col-lg-6 col-md-6 col-sm-6 col-12"
                                                        >
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="firstname"
                                                                    >First
                                                                    Name</label
                                                                >
                                                                <input
                                                                    id="firstname"
                                                                    type="text"
                                                                    placeholder="Trent"
                                                                    disabled
                                                                />
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="col-lg-6 col-md-6 col-sm-6 col-12"
                                                        >
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="lastname"
                                                                    >Last
                                                                    Name</label
                                                                >
                                                                <input
                                                                    id="lastname"
                                                                    type="text"
                                                                    placeholder="Adam"
                                                                    disabled
                                                                />
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="col-lg-6 col-md-6 col-sm-6 col-12"
                                                        >
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="username"
                                                                    >User
                                                                    Name</label
                                                                >
                                                                <input
                                                                    id="username"
                                                                    type="text"
                                                                    placeholder="Adam Milner"
                                                                    disabled
                                                                />
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="col-lg-6 col-md-6 col-sm-6 col-12"
                                                        >
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="phonenumber"
                                                                    >Phone
                                                                    Number</label
                                                                >
                                                                <input
                                                                    id="phonenumber"
                                                                    type="tel"
                                                                    placeholder="+1-202-555-0174"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="col-lg-12 col-md-6 col-sm-6 col-12"
                                                        >
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="address"
                                                                    >Shipping
                                                                    address</label
                                                                >
                                                                <input
                                                                    id="address"
                                                                    type="text"
                                                                    placeholder="1234 Parkland, Newzealand"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="col-12 mt--20"
                                                        >
                                                            <div
                                                                class="form-group mb--0"
                                                            >
                                                                <button
                                                                    type="submit"
                                                                    class="btn-default"
                                                                >
                                                                    Update Info
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    <!-- End Profile Row  -->
                                                </div>
                                                <div
                                                    class="tab-pane fade"
                                                    id="password"
                                                    role="tabpanel"
                                                    aria-labelledby="password-tab"
                                                >
                                                    <!-- Start Profile Row  -->
                                                    <form
                                                        id="password-form"
                                                        action="#"
                                                        class="rbt-profile-row rbt-default-form row row--15"
                                                    >
                                                        <div class="col-12">
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="currentpassword"
                                                                    >Current
                                                                    Password</label
                                                                >
                                                                <input
                                                                    id="currentpassword"
                                                                    type="password"
                                                                    placeholder="Current Password"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div class="col-12">
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="newpassword"
                                                                    >New
                                                                    Password</label
                                                                >
                                                                <input
                                                                    id="newpassword"
                                                                    type="password"
                                                                    placeholder="New Password"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div class="col-12">
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <label
                                                                    for="retypenewpassword"
                                                                    >Re-type New
                                                                    Password</label
                                                                >
                                                                <input
                                                                    id="retypenewpassword"
                                                                    type="password"
                                                                    placeholder="Re-type New Password"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="col-12 mt--20"
                                                        >
                                                            <div
                                                                class="form-group mb--0"
                                                            >
                                                                <button
                                                                    type="submit"
                                                                    class="btn-default"
                                                                >
                                                                    Update
                                                                    Password
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    <!-- End Profile Row  -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <!-- All Scripts  -->
        <div class="rbt-progress-parent">
            <svg
                class="rbt-back-circle svg-inner"
                width="100%"
                height="100%"
                viewBox="-1 -1 102 102"
            >
                <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
            </svg>
        </div>

        <!-- JS
============================================ -->
        <script src="assets/js/vendor/modernizr.min.js"></script>
        <script src="assets/js/vendor/jquery.min.js"></script>
        <script src="assets/js/vendor/bootstrap.min.js"></script>
        <script src="assets/js/vendor/waypoint.min.js"></script>
        <script src="assets/js/vendor/wow.min.js"></script>
        <script src="assets/js/vendor/counterup.min.js"></script>
        <script src="assets/js/vendor/sal.min.js"></script>
        <script src="assets/js/vendor/slick.min.js"></script>
        <script src="assets/js/vendor/text-type.js"></script>
        <script src="assets/js/vendor/prism.js"></script>
        <script src="assets/js/vendor/jquery.style.swicher.js"></script>
        <script src="assets/js/vendor/bootstrap-select.min.js"></script>
        <script src="assets/js/vendor/backto-top.js"></script>
        <script src="assets/js/vendor/js.cookie.js"></script>
        <script src="assets/js/vendor/jquery-one-page-nav.js"></script>
        <!-- Main JS -->
        <script src="assets/js/main.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', async () => {
                // Logout functionality
                document
                    .getElementById('logout-button')
                    .addEventListener('click', function () {
                        axios
                            .post('/auth/logout')
                            .then((response) => {
                                if (response.status === 200) {
                                    window.location.href = 'index.html'; // Redirect to login page
                                } else {
                                    console.error('Logout failed');
                                }
                            })
                            .catch((error) =>
                                console.error('Error during logout:', error)
                            );
                    });
            });
            document.addEventListener('DOMContentLoaded', async () => {
                try {
                    const response = await fetch('/api/user-info');
                    const user = await response.json();

                    document
                        .querySelectorAll('.hh-fullname')
                        .forEach(
                            (el) =>
                                (el.textContent = `${user.firstName} ${user.lastName}`)
                        );
                    document
                        .querySelectorAll('.hh-username')
                        .forEach((el) => (el.textContent = `${user.email}`));

                    document.getElementById('firstname').value = user.firstName;
                    document.getElementById('lastname').value = user.lastName;
                    document.getElementById('username').value = user.email;
                    document.getElementById('phonenumber').value =
                        user.phoneNumber || '';
                    document.getElementById('address').value =
                        user.address || '';

                    // Update profile picture
                    document.getElementById('profile-picture').src =
                        user.profilePicture ||
                        'assets/images/team/team-01sm.jpg';
                } catch (error) {
                    console.error('Error fetching user information:', error);
                }
            });

            document.addEventListener('DOMContentLoaded', async () => {
                document
                    .getElementById('profile-form')
                    .addEventListener('submit', async (event) => {
                        event.preventDefault();

                        const phoneNumber =
                            document.getElementById('phonenumber').value;
                        const address =
                            document.getElementById('address').value;
                        try {
                            const response = await fetch(
                                '/api/user-info/profile',
                                {
                                    method: 'PUT',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: JSON.stringify({
                                        phoneNumber,
                                        address,
                                    }),
                                }
                            );

                            const result = await response.json();
                            if (!response.ok) {
                                alert(response.body.message);
                                return;
                            }

                            alert('Information updated successfully');
                        } catch (error) {
                            console.error(
                                'Error updating user information:',
                                error
                            );
                            alert('Error updating information');
                        }
                    });
            });

            document.addEventListener('DOMContentLoaded', async () => {
                document
                    .getElementById('password-form')
                    .addEventListener('submit', async (event) => {
                        event.preventDefault();

                        const currentPassword =
                            document.getElementById('currentpassword').value;
                        const newPassword =
                            document.getElementById('newpassword').value;
                        const retypeNewPassword =
                            document.getElementById('retypenewpassword').value;

                        if (!currentPassword.trim() || !newPassword.trim()) {
                            alert('All fields are required');
                            return;
                        }
                        if (newPassword !== retypeNewPassword) {
                            alert('New passwords do not match');
                            return;
                        }

                        try {
                            const response = await fetch(
                                '/api/user-info/password',
                                {
                                    method: 'PUT',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: JSON.stringify({
                                        currentPassword,
                                        newPassword,
                                    }),
                                }
                            );

                            const result = await response.json();

                            if (!response.ok) {
                                alert(result.errors);
                                return;
                            }

                            alert('Password updated successfully');
                        } catch (error) {
                            console.error('Error updating password:', error);
                            alert('Error updating password');
                        }
                    });
            });
        </script>
    </body>
</html>
